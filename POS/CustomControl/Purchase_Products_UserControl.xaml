<UserControl x:Class="POS.CustomControl.Purchase_Products_UserControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             xmlns:validations="clr-namespace:POS.Validations"
             mc:Ignorable="d"
             MinWidth="1366"
             MinHeight="768"
             FontFamily="{StaticResource Montserrat}"
             FlowDirection="RightToLeft">

    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/Assets/UltraModernStyles.xaml"/>
            </ResourceDictionary.MergedDictionaries>
            
            <validations:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter"/>
            <validations:IndexPlusOneConverter x:Key="IndexPlusOneConverter"/>
            <validations:DoubleTextConverter x:Key="DoubleTextConverter"/>
        </ResourceDictionary>
    </UserControl.Resources>

    <UserControl.Triggers>
        <EventTrigger RoutedEvent="Loaded">
            <BeginStoryboard Storyboard="{StaticResource FadeInAnimation}"/>
        </EventTrigger>
    </UserControl.Triggers>

    <Grid Background="{StaticResource BackgroundGradientBrush}">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="2*"/> <!-- Products & Barcode -->
            <ColumnDefinition Width="3*"/> <!-- Purchase Cart -->
        </Grid.ColumnDefinitions>

        <!-- LEFT PANEL: Product Selection -->
        <Grid Grid.Column="0" Margin="20">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/> <!-- Header -->
                <RowDefinition Height="Auto"/> <!-- Barcode Input -->
                <RowDefinition Height="*"/>    <!-- Products List -->
            </Grid.RowDefinitions>

            <!-- Header -->
            <Border Grid.Row="0" CornerRadius="20" Margin="0,0,0,16"
                    RenderTransformOrigin="0.5,0.5">
                <Border.RenderTransform>
                    <TranslateTransform x:Name="LeftHeaderSlide"/>
                </Border.RenderTransform>
                <Border.Triggers>
                    <EventTrigger RoutedEvent="Loaded">
                        <BeginStoryboard>
                            <Storyboard>
                                <DoubleAnimation Storyboard.TargetName="LeftHeaderSlide" 
                                               Storyboard.TargetProperty="Y" 
                                               From="-80" To="0" Duration="0:0:0.7">
                                    <DoubleAnimation.EasingFunction>
                                        <BackEase EasingMode="EaseOut" Amplitude="0.4"/>
                                    </DoubleAnimation.EasingFunction>
                                </DoubleAnimation>
                            </Storyboard>
                        </BeginStoryboard>
                    </EventTrigger>
                </Border.Triggers>
                <Border.Background>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                        <GradientStop Color="#C2410C" Offset="0"/>
                        <GradientStop Color="#EA580C" Offset="0.5"/>
                        <GradientStop Color="#F59E0B" Offset="1"/>
                    </LinearGradientBrush>
                </Border.Background>
                <Border.Effect>
                    <DropShadowEffect Color="#C2410C" BlurRadius="30" ShadowDepth="0" Opacity="0.4"/>
                </Border.Effect>

                <Grid Margin="20,16">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <Border Grid.Column="0" Width="50" Height="50" CornerRadius="12" 
                            Background="White" Margin="0,0,16,0">
                        <Border.Effect>
                            <DropShadowEffect Color="White" BlurRadius="20" ShadowDepth="0" Opacity="0.6"/>
                        </Border.Effect>
                        <Viewbox Margin="10">
                            <Path Fill="{StaticResource WarningGradientBrush}"
                                  Data="M7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2zM1 2v2h2l3.6 7.59-1.35 2.45c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h12v-2H7.42c-.14 0-.25-.11-.25-.25l.03-.12.9-1.63h7.45c.75 0 1.41-.41 1.75-1.03l3.58-6.49c.08-.14.12-.31.12-.48 0-.55-.45-1-1-1H5.21l-.94-2H1zm16 16c-1.1 0-1.99.9-1.99 2s.89 2 1.99 2 2-.9 2-2-.9-2-2-2z"/>
                        </Viewbox>
                    </Border>

                    <StackPanel Grid.Column="1" VerticalAlignment="Center">
                        <TextBlock Text="Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª" FontSize="22" FontWeight="Bold" 
                                   Foreground="White"/>
                        <TextBlock Text="Ø£Ø¶Ù Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ù„ÙØ§ØªÙˆØ±Ø© Ø§Ù„Ø´Ø±Ø§Ø¡" FontSize="11" 
                                   Foreground="White" Opacity="0.85" Margin="0,2,0,0"/>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- Barcode Input -->
            <Border Grid.Row="1" Style="{StaticResource UltraModernCard}" Padding="20" Margin="0,0,0,16">
                <StackPanel>
                    <TextBlock Text="ðŸ” Ù…Ø³Ø­ Ø§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯" FontSize="14" FontWeight="SemiBold" 
                               Foreground="{StaticResource TextPrimaryColor}" Margin="0,0,0,12"/>
                    
                    <Border CornerRadius="12" BorderBrush="{StaticResource Neutral300Brush}" 
                            BorderThickness="2" Background="White">
                        <Grid>
                            <Path Fill="{StaticResource TextSecondaryColor}" Width="20" Height="20" 
                                  HorizontalAlignment="Right" Margin="14,0" Opacity="0.5"
                                  Data="M4 6h16v2H4zm0 5h16v2H4zm0 5h16v2H4z"/>
                            <TextBox x:Name="BarcodeTextBox"
                                     Style="{StaticResource UltraModernTextBox}"
                                     Text="{Binding Barcode, UpdateSourceTrigger=PropertyChanged}"
                                     BorderThickness="0"
                                     Background="Transparent"
                                     Padding="14,12,44,12"
                                     FontSize="16"
                                     FontWeight="Medium"
                                     materialDesign:HintAssist.Hint="Ø§ÙƒØªØ¨ Ø£Ùˆ Ø§Ù…Ø³Ø­ Ø§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯..." />
                        </Grid>
                    </Border>

                    <Button Style="{StaticResource UltraModernPrimaryButton}"
                            Command="{Binding AddProductByBarcodeCommand}"
                            Height="50"
                            Margin="0,12,0,0">
                        <StackPanel Orientation="Horizontal">
                            <Path Fill="White" Width="22" Height="22" Margin="0,0,10,0"
                                  Data="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
                            <TextBlock Text="Ø¥Ø¶Ø§ÙØ© Ù„Ù„ÙØ§ØªÙˆØ±Ø©" FontSize="15" FontWeight="SemiBold"/>
                        </StackPanel>
                    </Button>
                </StackPanel>
            </Border>

            <!-- Products DataGrid -->
            <Border Grid.Row="2" Style="{StaticResource UltraModernCard}">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- Search Header -->
                    <Border Grid.Row="0" BorderBrush="{StaticResource Neutral200Brush}" BorderThickness="0,0,0,1" Padding="16,12">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <TextBlock Grid.Column="0" Text="ðŸ“¦ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª" FontSize="14" FontWeight="SemiBold" 
                                       Foreground="{StaticResource TextPrimaryColor}" VerticalAlignment="Center"/>

                            <Border Grid.Column="1" CornerRadius="8" BorderBrush="{StaticResource Neutral300Brush}" 
                                    BorderThickness="1.5" Background="White" Width="200">
                                <TextBox Style="{StaticResource UltraModernTextBox}"
                                         Text="{Binding TextSearch, UpdateSourceTrigger=PropertyChanged}"
                                         BorderThickness="0"
                                         Background="Transparent"
                                         Padding="10,8"
                                         FontSize="13"
                                         materialDesign:HintAssist.Hint="Ø¨Ø­Ø«..." />
                            </Border>
                        </Grid>
                    </Border>

                    <!-- Products Grid -->
                    <DataGrid Grid.Row="1"
                              ItemsSource="{Binding ProductList}"
                              SelectedItem="{Binding SelectedProduct}"
                              Style="{StaticResource UltraModernDataGrid}"
                              AutoGenerateColumns="False"
                              CanUserAddRows="False"
                              IsReadOnly="True"
                              SelectionMode="Single"
                              VirtualizingPanel.IsVirtualizing="True"
                              VirtualizingPanel.VirtualizationMode="Recycling">
                        
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="#" Width="40" Binding="{Binding RelativeSource={RelativeSource AncestorType=DataGridRow}, Converter={StaticResource IndexPlusOneConverter}}"/>
                            
                            <DataGridTemplateColumn Header="Ø§Ù„Ù…Ù†ØªØ¬" Width="*">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal" Margin="4">
                                            <Border Width="32" Height="32" CornerRadius="6" Margin="0,0,10,0"
                                                    Background="{StaticResource WarningGradientBrush}">
                                                <TextBlock Text="{Binding Name, Converter={StaticResource InitialsConverter}}"
                                                           Foreground="White"
                                                           FontSize="12"
                                                           FontWeight="Bold"
                                                           HorizontalAlignment="Center"
                                                           VerticalAlignment="Center"/>
                                            </Border>
                                            <StackPanel VerticalAlignment="Center">
                                                <TextBlock Text="{Binding Name}" FontWeight="SemiBold" FontSize="12"/>
                                                <TextBlock Text="{Binding Barcode}" FontSize="10" Foreground="{StaticResource TextSecondaryColor}" Margin="0,1,0,0"/>
                                            </StackPanel>
                                        </StackPanel>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>

                            <DataGridTemplateColumn Header="Ø§Ù„Ø³Ø¹Ø±" Width="80">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding SalePrice, StringFormat={}{0:N2}}" 
                                                   FontWeight="SemiBold" FontSize="12"
                                                   HorizontalAlignment="Center"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </Border>
        </Grid>

        <!-- RIGHT PANEL: Purchase Cart -->
        <Grid Grid.Column="1" Margin="0,20,20,20">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/> <!-- Header -->
                <RowDefinition Height="*"/>    <!-- Cart Items -->
                <RowDefinition Height="Auto"/> <!-- Totals -->
                <RowDefinition Height="Auto"/> <!-- Actions -->
            </Grid.RowDefinitions>

            <!-- Header -->
            <Border Grid.Row="0" CornerRadius="20" Margin="0,0,0,16"
                    RenderTransformOrigin="0.5,0.5">
                <Border.RenderTransform>
                    <TranslateTransform x:Name="RightHeaderSlide"/>
                </Border.RenderTransform>
                <Border.Triggers>
                    <EventTrigger RoutedEvent="Loaded">
                        <BeginStoryboard>
                            <Storyboard>
                                <DoubleAnimation Storyboard.TargetName="RightHeaderSlide" 
                                               Storyboard.TargetProperty="Y" 
                                               From="-80" To="0" Duration="0:0:0.7">
                                    <DoubleAnimation.EasingFunction>
                                        <BackEase EasingMode="EaseOut" Amplitude="0.4"/>
                                    </DoubleAnimation.EasingFunction>
                                </DoubleAnimation>
                            </Storyboard>
                        </BeginStoryboard>
                    </EventTrigger>
                </Border.Triggers>
                <Border.Background>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                        <GradientStop Color="#047857" Offset="0"/>
                        <GradientStop Color="#10B981" Offset="0.5"/>
                        <GradientStop Color="#34D399" Offset="1"/>
                    </LinearGradientBrush>
                </Border.Background>
                <Border.Effect>
                    <DropShadowEffect Color="#047857" BlurRadius="30" ShadowDepth="0" Opacity="0.4"/>
                </Border.Effect>

                <Grid Margin="24,18">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <Border Grid.Column="0" Width="60" Height="60" CornerRadius="15" 
                            Background="White" Margin="0,0,20,0">
                        <Border.Effect>
                            <DropShadowEffect Color="White" BlurRadius="20" ShadowDepth="0" Opacity="0.6"/>
                        </Border.Effect>
                        <Viewbox Margin="12">
                            <Path Fill="{StaticResource SuccessGradientBrush}"
                                  Data="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z"/>
                        </Viewbox>
                    </Border>

                    <StackPanel Grid.Column="1" VerticalAlignment="Center">
                        <TextBlock Text="ÙØ§ØªÙˆØ±Ø© Ø§Ù„Ø´Ø±Ø§Ø¡" FontSize="28" FontWeight="Bold" 
                                   Foreground="White" Margin="0,0,0,4"/>
                        <TextBlock Text="Ø¥Ø¯Ø§Ø±Ø© Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„ÙØ§ØªÙˆØ±Ø©" FontSize="13" 
                                   Foreground="White" Opacity="0.85"/>
                    </StackPanel>

                    <!-- Invoice Number -->
                    <Border Grid.Column="2" Background="White" CornerRadius="12" Padding="16,10" VerticalAlignment="Center">
                        <StackPanel>
                            <TextBlock Text="Ø±Ù‚Ù… Ø§Ù„ÙØ§ØªÙˆØ±Ø©" FontSize="11" Foreground="{StaticResource TextSecondaryColor}" HorizontalAlignment="Center"/>
                            <TextBlock Text="{Binding PurchaseInvoiceNumber}" FontSize="18" FontWeight="ExtraBold" 
                                       Foreground="{StaticResource Success900Brush}" HorizontalAlignment="Center" Margin="0,2,0,0"/>
                        </StackPanel>
                    </Border>
                </Grid>
            </Border>

            <!-- Cart Items DataGrid -->
            <Border Grid.Row="1" Style="{StaticResource UltraModernCard}" Margin="0,0,0,16">
                <DataGrid ItemsSource="{Binding CartItemsList}"
                          SelectedItem="{Binding SelectedCartItem}"
                          Style="{StaticResource UltraModernDataGrid}"
                          AutoGenerateColumns="False"
                          CanUserAddRows="False"
                          SelectionMode="Single"
                          VirtualizingPanel.IsVirtualizing="True">
                    
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="#" Width="40" Binding="{Binding RelativeSource={RelativeSource AncestorType=DataGridRow}, Converter={StaticResource IndexPlusOneConverter}}"/>
                        
                        <DataGridTextColumn Header="Ø§Ù„Ù…Ù†ØªØ¬" Width="2*" Binding="{Binding ItemName}"/>
                        
                        <DataGridTemplateColumn Header="Ø§Ù„ÙƒÙ…ÙŠØ©" Width="1*">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBox Text="{Binding Quantity, UpdateSourceTrigger=PropertyChanged, Converter={StaticResource DoubleTextConverter}}"
                                             Style="{StaticResource UltraModernTextBox}"
                                             BorderThickness="0"
                                             Padding="8,6"
                                             FontSize="13"
                                             FontWeight="SemiBold"
                                             HorizontalContentAlignment="Center"/>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>

                        <DataGridTemplateColumn Header="Ø³Ø¹Ø± Ø§Ù„Ø´Ø±Ø§Ø¡" Width="1*">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBox Text="{Binding BuyingPrice, UpdateSourceTrigger=PropertyChanged, Converter={StaticResource DoubleTextConverter}}"
                                             Style="{StaticResource UltraModernTextBox}"
                                             BorderThickness="0"
                                             Padding="8,6"
                                             FontSize="13"
                                             FontWeight="SemiBold"
                                             HorizontalContentAlignment="Center"/>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>

                        <DataGridTemplateColumn Header="Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ" Width="1.2*">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding TotalPrice, StringFormat={}{0:N2}}" 
                                               FontWeight="Bold" FontSize="13"
                                               Foreground="{StaticResource Success900Brush}"
                                               HorizontalAlignment="Center"/>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>

                        <DataGridTemplateColumn Header="Ø­Ø°Ù" Width="60">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Button Style="{StaticResource UltraModernGhostButton}"
                                            Command="{Binding DataContext.RemoveItemCommand, RelativeSource={RelativeSource AncestorType=DataGrid}}"
                                            CommandParameter="{Binding}"
                                            Width="32" Height="32" Padding="0">
                                        <Path Fill="{StaticResource Danger600Brush}" Width="16" Height="16"
                                              Data="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                                    </Button>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                    </DataGrid.Columns>
                </DataGrid>
            </Border>

            <!-- Totals Summary -->
            <Border Grid.Row="2" Style="{StaticResource UltraModernCard}" Padding="24" Margin="0,0,0,16">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <!-- Subtotal -->
                    <TextBlock Grid.Row="0" Grid.Column="0" Text="Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙØ±Ø¹ÙŠ:" FontSize="15" Foreground="{StaticResource TextSecondaryColor}" Margin="0,0,0,10"/>
                    <StackPanel Grid.Row="0" Grid.Column="1" Orientation="Horizontal" Margin="0,0,0,10">
                        <TextBlock Text="{Binding SubTotal, StringFormat={}{0:N2}}" FontSize="18" FontWeight="Bold"
                                   Foreground="{StaticResource Primary900Brush}"/>
                        <TextBlock Text="Ø¬.Ù…" FontSize="14" Foreground="{StaticResource TextSecondaryColor}" Margin="6,2,0,0"/>
                    </StackPanel>

                    <!-- Discount -->
                    <TextBlock Grid.Row="1" Grid.Column="0" Text="Ø§Ù„Ø®ØµÙ…:" FontSize="15" Foreground="{StaticResource TextSecondaryColor}" Margin="0,0,0,10"/>
                    <StackPanel Grid.Row="1" Grid.Column="1" Orientation="Horizontal" Margin="0,0,0,10">
                        <TextBox Text="{Binding DiscountPercentage, UpdateSourceTrigger=PropertyChanged, Converter={StaticResource DoubleTextConverter}}"
                                 Style="{StaticResource UltraModernTextBox}"
                                 Width="80"
                                 Padding="10,6"
                                 FontSize="14"
                                 FontWeight="SemiBold"
                                 HorizontalContentAlignment="Center"/>
                        <TextBlock Text="%" FontSize="14" Foreground="{StaticResource TextSecondaryColor}" Margin="6,6,0,0"/>
                    </StackPanel>

                    <!-- Tax -->
                    <TextBlock Grid.Row="2" Grid.Column="0" Text="Ø§Ù„Ø¶Ø±ÙŠØ¨Ø©:" FontSize="15" Foreground="{StaticResource TextSecondaryColor}" Margin="0,0,0,10"/>
                    <StackPanel Grid.Row="2" Grid.Column="1" Orientation="Horizontal" Margin="0,0,0,10">
                        <TextBox Text="{Binding TaxPercentage, UpdateSourceTrigger=PropertyChanged, Converter={StaticResource DoubleTextConverter}}"
                                 Style="{StaticResource UltraModernTextBox}"
                                 Width="80"
                                 Padding="10,6"
                                 FontSize="14"
                                 FontWeight="SemiBold"
                                 HorizontalContentAlignment="Center"/>
                        <TextBlock Text="%" FontSize="14" Foreground="{StaticResource TextSecondaryColor}" Margin="6,6,0,0"/>
                    </StackPanel>

                    <!-- Total -->
                    <Border Grid.Row="3" Grid.Column="0" Grid.ColumnSpan="2" CornerRadius="12" Padding="16,12" Margin="0,10,0,0">
                        <Border.Background>
                            <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                <GradientStop Color="#047857" Offset="0"/>
                                <GradientStop Color="#10B981" Offset="1"/>
                            </LinearGradientBrush>
                        </Border.Background>
                        <Grid>
                            <TextBlock Text="Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ:" FontSize="18" FontWeight="Bold" Foreground="White"/>
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Left">
                                <TextBlock Text="{Binding Total, StringFormat={}{0:N2}}" FontSize="32" FontWeight="ExtraBold" Foreground="White"/>
                                <TextBlock Text="Ø¬.Ù…" FontSize="18" Foreground="White" Opacity="0.9" Margin="10,12,0,0"/>
                            </StackPanel>
                        </Grid>
                    </Border>
                </Grid>
            </Border>

            <!-- Action Buttons -->
            <Grid Grid.Row="3">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <Button Grid.Column="0" Style="{StaticResource UltraModernSuccessButton}"
                        Command="{Binding SavePurchaseCommand}"
                        Height="64"
                        Margin="0,0,8,0">
                    <StackPanel Orientation="Horizontal">
                        <Path Fill="White" Width="24" Height="24" Margin="0,0,12,0"
                              Data="M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z"/>
                        <TextBlock Text="Ø­ÙØ¸ Ø§Ù„ÙØ§ØªÙˆØ±Ø©" FontSize="16" FontWeight="Bold"/>
                    </StackPanel>
                </Button>

                <Button Grid.Column="1" Style="{StaticResource UltraModernGhostButton}"
                        BorderBrush="{StaticResource Danger500Brush}"
                        Foreground="{StaticResource Danger500Brush}"
                        Command="{Binding ClearPurchaseCommand}"
                        Height="64"
                        Margin="8,0,0,0">
                    <StackPanel Orientation="Horizontal">
                        <Path Fill="{StaticResource Danger600Brush}" Width="24" Height="24" Margin="0,0,12,0"
                              Data="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/>
                        <TextBlock Text="Ø¥Ù„ØºØ§Ø¡" FontSize="16" FontWeight="Bold"/>
                    </StackPanel>
                </Button>
            </Grid>
        </Grid>
    </Grid>
</UserControl>
